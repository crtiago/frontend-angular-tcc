<div class="card m-5" style="opacity: 0.9;">
    <h5 class="card-header">Cadastro de Usuário</h5>
    <div class="card-body">
        <form [formGroup]="formularioDeUsuario" (ngSubmit)="cadastrar(formularioDeUsuario.value)">

            <!--Primeira Linha de Inputs-->
            <div class="form-row">

                <!--Input Nome-->
                <div class="form-group col-4">
                    <label>Nome Completo</label>
                    <input type="text" formControlName="nome" class="form-control"
                        [ngClass]="{ 'is-invalid':!f.nome.pristine && f.nome.errors }" />
                    <div *ngIf="!f.nome.pristine && f.nome.errors" class="invalid-feedback">
                        <div *ngIf="f.nome.errors.required">Nome é obrigatório.</div>
                    </div>
                </div>

                <!--Input CPF-->
                <div class="form-group col-2">
                    <label>CPF</label>
                    <input type="text" formControlName="cpf" class="form-control" placeholder="000.000.000-00"
                        mask="000.000.000-00" [ngClass]="{ 'is-invalid': !f.cpf.pristine && f.cpf.errors }" />
                    <div *ngIf="!f.cpf.pristine && f.cpf.errors" class="invalid-feedback">
                        <div *ngIf="f.cpf.errors.cpfInvalido">Insira um CPF válido.</div>
                        <div *ngIf="f.cpf.errors.required">CPF é obrigatório.</div>
                    </div>
                </div>

                <!--Input Nascimento-->
                <div class="form-group col-2">
                    <label>Data de Nascimento</label>
                    <input type="date" formControlName="nascimento" class="form-control"
                        [ngClass]="{ 'is-invalid':!f.nascimento.pristine && f.nascimento.errors }" />
                    <div *ngIf="!f.nascimento.pristine && f.nascimento.errors" class="invalid-feedback">
                        <div
                            *ngIf="!f.nascimento.errors.required && !f.nascimento.errors.pattern && f.nascimento.errors.menorDe16">
                            Você deve ter mais de 16 anos.
                        </div>
                        <div *ngIf="f.nascimento.errors.required">Data de nascimento é obrigatória.</div>
                        <div *ngIf="f.nascimento.errors.pattern">
                            A data está incorreta.
                        </div>
                    </div>
                </div>

                <!--Input Imagem de Perfil-->
                <div class="form-group col-2">
                    <label>Imagem de Perfil</label>
                    <input (change)="converteImagem64($event)" type="file" name="myImage" accept="image/*" />
                </div>
            </div>

            <!--Segunda Linha de Inputs-->
            <div class="form-row">

                <!--Input Email-->
                <div class="form-group col-6">
                    <label>Email</label>
                    <input type="text" formControlName="email" class="form-control"
                        [ngClass]="{ 'is-invalid': !f.email.pristine && f.email.errors }" />
                    <div *ngIf=" f.email.errors" class="invalid-feedback">
                        <div *ngIf="!f.email.pristine && f.email.errors.required">Email é obrigatório.</div>
                        <div *ngIf="f.email.errors.email">O email deve ser um endereço de email válido.</div>
                    </div>
                </div>

                <!--Input Telefone-->
                <div class="form-group col-2">
                    <label>Telefone</label>
                    <input type="text" formControlName="telefone" class="form-control" placeholder="(00) 00000-0000"
                        mask="(00) 00000-0000" [ngClass]="{ 'is-invalid':!f.telefone.pristine && f.telefone.errors }" />
                    <div *ngIf="!f.telefone.pristine && f.telefone.errors" class="invalid-feedback">
                        <div *ngIf="f.telefone.errors.minlength">Insira um telefone válido.</div>
                    </div>
                </div>

                <!--Select Instituição-->
                <div class="form-group col-4">
                    <label>Instituição</label>
                    <select formControlName="instituicao" class="form-control"
                        [ngClass]="{ 'is-invalid': !f.instituicao.pristine && f.instituicao.errors }">
                        <option value=""></option>
                        <option value="IFSC">IFSC</option>
                        <option value="UFSC">UFSC</option>
                        <option value="UFRS">UFRS</option>
                        <option value="UNIPLAC">UNIPLAC</option>
                    </select>
                    <div *ngIf="!f.instituicao.pristine && f.instituicao.errors" class="invalid-feedback">
                        <div *ngIf="f.instituicao.errors.required">Instituição é obrigatória.</div>
                    </div>
                </div>
            </div>

            <!--Terceira Linha dos Inputs-->
            <div class="form-row">

                <!--Input Senha-->
                <div class="form-group col-3">
                    <label>Senha</label>
                    <input type="password" formControlName="senha" class="form-control"
                        [ngClass]="{ 'is-invalid':!f.senha.pristine && f.senha.errors }" />
                    <div *ngIf="!f.senha.pristine && f.senha.errors" class="invalid-feedback">
                        <div *ngIf="f.senha.errors.required">Senha é obrigatória.</div>
                        <div *ngIf="f.senha.errors.minlength">A senha deve ter pelo menos 6 caracteres.</div>
                    </div>
                </div>

                <!--Input Confirmar Senha-->
                <div class="form-group col-3">
                    <label>Confirmar Senha</label>
                    <input type="password" formControlName="confirmarSenha" class="form-control"
                        [ngClass]="{ 'is-invalid': !f.confirmarSenha.pristine && f.confirmarSenha.errors }" />
                    <div *ngIf="!f.confirmarSenha.pristine && f.confirmarSenha.errors" class="invalid-feedback">
                        <div *ngIf="f.confirmarSenha.errors.required">Confirmar senha é obrigatório.</div>
                        <div *ngIf="f.confirmarSenha.errors.naoConferem">Senhas não conferem.</div>
                    </div>
                </div>

                <!--Select Tipo de Usuário-->
                <div class="form-group col-2">
                    <label>Tipo de Usuário</label>
                    <select (change)="getTipo($event)" formControlName="tipoUsuario" class="form-control"
                        [ngClass]="{ 'is-invalid': !f.tipoUsuario.pristine && f.tipoUsuario.errors }">
                        <option value="1">Aluno</option>
                        <option value="2">Professor</option>
                    </select>
                    <div *ngIf="!f.tipoUsuario.pristine && f.tipoUsuario.errors" class="invalid-feedback">
                        <div *ngIf="f.tipoUsuario.errors.required">Tipo de Usuário é obrigatório.</div>
                    </div>
                </div>

                <!--Inputs do Tipo Usuário = Aluno-->
                <!--Input Matricula do Aluno-->
                <div *ngIf="f.tipoUsuario.value == 1" class="form-group col-2">
                    <label>Matricula</label>
                    <input type="text" mask="000000000000000000" formControlName="matricula" class="form-control"
                        [ngClass]="{ 'is-invalid':!f.matricula.pristine && f.matricula.errors }" />
                    <div *ngIf="!f.matricula.pristine && f.matricula.errors" class="invalid-feedback">
                        <div *ngIf="f.matricula.errors.required">Matricula é obrigatória.</div>
                    </div>
                </div>

                <!--Input Ano Ingresso do Aluno-->
                <div *ngIf="f.tipoUsuario.value == 1" class="form-group col-2">
                    <label>Ano de Ingresso</label>
                    <input type="text" mask="0000" formControlName="anoIngresso" class="form-control"
                        [ngClass]="{ 'is-invalid':!f.anoIngresso.pristine && f.anoIngresso.errors }" />
                    <div *ngIf="!f.anoIngresso.pristine && f.anoIngresso.errors" class="invalid-feedback">
                        <div *ngIf="f.anoIngresso.errors.required">Ano de Ingresso é obrigatório.</div>
                        <div
                            *ngIf="(f.anoIngresso.errors.anoInvalido || f.anoIngresso.errors.minlength) && !f.anoIngresso.errors.required">
                            Insira um ano válido.
                        </div>
                    </div>
                </div>
                <!--Fim dos Inputs do Tipo Usuário = Aluno-->

                <!--Input do Tipo Usuário = Professor-->
                <div *ngIf="f.tipoUsuario.value == 2" class="form-group col-4">
                    <label>Disciplinas de Interesse</label>
                    <select (change)="getDisciplinas($event)" formControlName="disciplinas" class="form-control"
                        [ngClass]="{ 'is-invalid': !f.disciplinas.pristine && f.disciplinas.errors }">
                        <option *ngFor="let disciplina of todasDisciplinas" [value]="disciplina">{{ disciplina }}
                        </option>
                    </select>
                    <div *ngIf="!f.disciplinas.pristine && f.disciplinas.errors" class="invalid-feedback">
                        <div *ngIf="f.disciplinas.required">Escolha no minímo uma disciplina de interesse.</div>

                    </div>
                </div>
                <!--Fim dos Inputs do Tipo Usuário = Professor-->

            </div>

            <!--Botões com as disciplinas escolhidas pelo Professor-->
            <label *ngIf="f.tipoUsuario.value == 2">Disciplinas de Interesse</label>
            <div *ngIf="f.tipoUsuario.value == 2" class="form-row">
                <h5 *ngFor="let disciplina of disciplinasInteresse" style="margin: 0px 5px 8px;">
                    <span class="badge badge-success">{{disciplina}}
                        <button type="button" (click)="removerDisciplina(disciplina)" class="close" data-dismiss="alert"
                            aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </span>
                </h5>
            </div>

            <!--Botões do formulário-->
            <div class="text-center">

                <button [disabled]="!formularioDeUsuario.valid" style="float: right;">
                    <span *ngIf="carregar" class="spinner-border spinner-border-sm mr-1"></span>Cadastrar</button>
                <button style="float: right;" type="button" routerLink="/login">Cancelar</button>

            </div>
        </form>
    </div>
</div>

<!--Modal para Sucesso-->
<div class="modal fade" style="text-align: center;" #modalSucesso id="modalAlerta" tabindex="-1" role="dialog"
    aria-labelledby="modalAlertaLabel" aria-hidden="!carregar" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">

                <div class="alerta">
                    <img src="../../../assets/img/acerto.svg" alt="">
                    <h1>Cadastro concluído!</h1>
                    <p>{{mensagem}}</p>
                </div>

            </div>

            <div class="modal-footer">
                <button type="button" data-dismiss="modal" routerLink="/login">Entrar</button>
            </div>

        </div>
    </div>
</div>

<!--Modal para erro-->
<div class="modal fade" style="text-align: center;" #modalErro id="modalAlerta" tabindex="-1" role="dialog"
    aria-labelledby="modalAlertaLabel" aria-hidden="!carregar" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">

            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label=""><span>×</span></button>
            </div>

            <div class="modal-body">

                <!--Se acontecer erro, ele habilita essa opção-->
                <div class="alerta">
                    <img src="../../../assets/img/erro.svg" alt="">
                    <h1>Erro no cadastro!</h1>
                    <p>{{erro}}</p>
                </div>

            </div>

        </div>
    </div>
</div>



<!-- TODO
    Mudar o estilo do input Imagem
    Adicionar list faculdades
    Mudar select para abrir para baixo
-->